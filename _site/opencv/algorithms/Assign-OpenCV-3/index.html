<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>OpenCV 과제: 영상 색상 채우기 #3 - 최종 - JH’s Labs</title>
<meta name="description" content="질문">


  <meta name="author" content="Jonghyeok Kim">
  
  <meta property="article:author" content="Jonghyeok Kim">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="JH's Labs">
<meta property="og:title" content="OpenCV 과제: 영상 색상 채우기 #3 - 최종">
<meta property="og:url" content="http://localhost:4000/opencv/algorithms/Assign-OpenCV-3/">


  <meta property="og:description" content="질문">







  <meta property="article:published_time" content="2021-02-26T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/opencv/algorithms/Assign-OpenCV-3/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "종혁",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="JH's Labs Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="120x120" href="/assets/images/blog/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/blog/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/blog/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/images/blog/favicon/site.webmanifest">
<link rel="mask-icon" href="/assets/images/blog/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/blog/blog.png" alt=""></a>
        
        <a class="site-title" href="/">
          JH's Labs
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="http://psg.or.kr/">PSG</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
    <div class="sidebar sticky">
  
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/blog/profile.svg" alt="Jonghyeok Kim" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Jonghyeok Kim</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Interests: <br />Computer Vision<br />Machine Learning<br />Image and Voice Recognition</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">JeonJu</span>
        </li>
      

      
        
          
            <li><a href="http://psg.or.kr" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://github.com/enfycius" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github fa-custom" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.instagram.com/___o7k/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:20201967@edu.hanbat.ac.kr">
            <meta itemprop="email" content="20201967@edu.hanbat.ac.kr" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="OpenCV 과제: 영상 색상 채우기 #3 - 최종">
    <meta itemprop="description" content="질문">
    <meta itemprop="datePublished" content="2021-02-26T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">OpenCV 과제: 영상 색상 채우기 #3 - 최종
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-02-26T00:00:00+09:00">February 26, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          14 분 소요
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#질문">질문</a>
    <ul>
      <li><a href="#내용">내용</a></li>
    </ul>
  </li>
  <li><a href="#답변">답변</a>
    <ul>
      <li><a href="#내용-1">내용</a>
        <ul>
          <li><a href="#전체-코드">전체 코드</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <h1 id="질문">질문</h1>

<h2 id="내용">내용</h2>

<p>다음 영상 이름은 “hwfig5-1.jpg”이다. 이 영상에 대해 다음을 프로그래밍하시오.</p>

<p><img src="/assets/images/opencv/assignment/opencv-assign-1.jpg" alt="hwfig5-1.jpg" /></p>

<ol>
  <li>
    <p>위 영상을 Mat img1 = imread() 함수를 이용하여 grayscale 영상으로 읽어 오시오.</p>
  </li>
  <li>
    <p>또 다른 영상을 저장하기 위해 Mat img2;로 하고, 이것은 칼라(3채널)로 저장하기 위해 선언하시오.</p>
  </li>
  <li>
    <p>위 영상에 대해 히스토그램을 구하시오.</p>
  </li>
  <li>
    <p>히스토그램에서 최대 peak가 되는 값 4개를 구하시오. (육안으로…)</p>
  </li>
  <li>
    <p>각 4개 peak점의 가운데 값을 문턱치로 사용하여 가장 어두운 직사각형은 파랑색, 원은 녹색, 삼각형은 빨강색, 배경은 노랑색으로 하여 img2를 만들어 display하시오.</p>
  </li>
</ol>

<h1 id="답변">답변</h1>

<h2 id="내용-1">내용</h2>

<p>그럼 2편에 이어서 위 문제를 풀이해보겠다.</p>

<p>이제 5번을 풀이할 차례이다.</p>

<p>2편에서 작성한 전체 코드를 가져오자.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;opencv2/opencv.hpp&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">cv</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">find_Peaks</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">src</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>      <span class="c1">// peaks들의 값을 저장할 변수</span>
    <span class="n">Mat</span> <span class="n">dup_src</span><span class="p">;</span>            <span class="c1">// 매개변수 src를 복제하여 저장할 변수</span>
    
    <span class="n">Point</span> <span class="n">p</span><span class="p">;</span>        <span class="c1">// 최댓값의 위치를 저장하는 변수</span>
    
    <span class="n">dup_src</span> <span class="o">=</span> <span class="n">src</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>      <span class="c1">// 매개변수 src를 복제하여 dup_src에 담는다.</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// 위 이미지에서 보여지는 히스토그램이 4개 있으므로, 4회 반복.</span>
        <span class="n">minMaxLoc</span><span class="p">(</span><span class="n">dup_src</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">);</span>       <span class="c1">// 우리는 히스토그램의 Peak 값만 필요하므로 최댓값과 최솟값을 저장할 변수는 필요치 않음.</span>
        <span class="n">peaks</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>       <span class="c1">// 위치 값 중 y값만을 peaks에 담자.</span>
        <span class="n">dup_src</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>        <span class="c1">// 최솟값인 0을 넣자.</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>           <span class="c1">// p.y의 주변 반경 10만큼을 최솟값 0으로 채운다.</span>
            <span class="n">dup_src</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   
            <span class="n">dup_src</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">peaks</span><span class="p">;</span>       <span class="c1">// peaks 값들 반환</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">hist</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span> <span class="o">=</span> <span class="n">find_Peaks</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">bin_w</span> <span class="o">=</span> <span class="n">cvRound</span><span class="p">(</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">hist</span><span class="p">.</span><span class="n">cols</span> <span class="o">/</span> <span class="mi">350</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">line</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hist</span><span class="p">.</span><span class="n">rows</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Peaks"</span><span class="p">,</span> <span class="n">hist</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">peaks</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Mat</span> <span class="nf">draw_Histogram</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">hist</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">hist_w</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">hist_h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">hist_size</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">bin_w</span> <span class="o">=</span> <span class="n">cvRound</span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">hist_w</span><span class="o">/</span><span class="n">hist_size</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">histImage</span><span class="p">(</span><span class="n">hist_h</span><span class="p">,</span> <span class="n">hist_w</span><span class="p">,</span> <span class="n">CV_8UC3</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>

    <span class="n">normalize</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">histImage</span><span class="p">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">NORM_MINMAX</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Mat</span><span class="p">());</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">hist_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Point</span> <span class="n">pts</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">hist_h</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">hist_h</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">hist_h</span> <span class="o">-</span> <span class="n">cvRound</span><span class="p">(</span><span class="n">hist</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">hist_h</span><span class="o">-</span><span class="n">cvRound</span><span class="p">(</span><span class="n">hist</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">hist_h</span><span class="p">)};</span>

        <span class="n">fillConvexPoly</span><span class="p">(</span><span class="n">histImage</span><span class="p">,</span> <span class="n">pts</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Histogram"</span><span class="p">,</span> <span class="n">histImage</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">histImage</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>draw_Line Function은 우리가 2편에서 작성했었던 것처럼 std::vector&lt;int&gt;형의 peaks 변수를 반환했기 때문에 main 함수에서 이를 받아야 median 값을 도출할 수 있다.</p>

<p>그러므로 std::vector&lt;int&gt;형의 peaks를 main 함수 내에 하나 선언한 후, peaks를 받자.</p>

<p>즉,</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>          <span class="c1">// draw_Line Function 반환 값을 저장할 변수 선언</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>         <span class="c1">// 반환 값을 담자.</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>peaks 내에는 히스토그램의 각 Peaks들의 값이 저장되어 있으므로, 문제의 5번 항목에서 요구하는 것처럼 4개의 Peaks들의 가운데 값, 즉 median 값을 산출하여 이를 문턱치로 사용하자.</p>

<p>우리는 이미 find_Peaks 함수에서 peaks vector에 값을 넣을 때, 가장 큰 히스토그램의 Peaks 값들부터 순차적으로 넣어줬기 때문에(minMaxLoc Function 덕분이다.) 실제로 peaks vector 내부의 값들은 정렬이 완료된 상태이다.</p>

<p>또한, 총 4개의 Peaks들이 들어가 있으므로, 즉 이는 홀수가 아닌 짝수이므로 가운데를 중심으로 바로 왼쪽에 위치한 원소의 값과 바로 오른쪽에 위치한 원소의 값을 더한 후 2로 나누어줘야 중앙값(median)이 도출된다.</p>

<p>이를 코드로 보이면 다음과 같다.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>          <span class="c1">// draw_Line Function 반환 값을 저장할 변수 선언</span>
    <span class="kt">double</span> <span class="n">median</span><span class="p">;</span>              <span class="c1">// 중앙값을 저장할 변수 선언</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>         <span class="c1">// 반환 값을 담자.</span>

    <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>위 코드 중 다음의 코드를 보자.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
</code></pre></div></div>

<p>median 값을 도출할 때 필자가 위에서 언급했듯이, peaks 내부에는 총 4개의 Element들이 들어있기 때문에, peaks.size() 즉 peaks의 크기 4를 2로 나눈 후 -1을 하게 되면, 가운데를 중심으로 바로 왼쪽에 위치한 원소의 인덱스 값이 도출된다.</p>

<p>마찬가지 방식으로 가운데를 중심으로 바로 오른쪽에 위치한 원소의 인덱스 값도 peaks.size() 즉 peaks의 크기 4를 2로 나눈 후 +1을 하게 되면 도출된다.</p>

<p>각 인덱스 값에 대응되는 원소의 값들을 불러들여서 서로 더한 후 2로 나누어주면 median 값은 도출된다.</p>

<p>여기까지 완료했다면, 이제 문턱치를 구해보자.</p>

<p>문턱치 값을 구하기 위해서 OpenCV에서는 threshold Function을 제공해주므로, 이를 이용하면 되겠다.</p>

<p>threshold Function은 다음과 같다.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span> <span class="n">cv</span><span class="o">::</span><span class="n">threshold</span><span class="p">(</span><span class="n">InputArray</span> <span class="n">src</span><span class="p">,</span>
                     <span class="n">OutputArray</span> <span class="n">dst</span><span class="p">,</span>
                     <span class="kt">double</span> <span class="n">thresh</span><span class="p">,</span>
                     <span class="kt">double</span> <span class="n">maxval</span><span class="p">,</span>
                     <span class="kt">int</span> <span class="n">type</span>
<span class="p">)</span>
</code></pre></div></div>

<p>위 함수에 대한 더 자세한 설명은 아래의 Reference를 참조하자.</p>

<p><a href="https://docs.opencv.org/master/d7/d1b/group__imgproc__misc.html#gae8a4a146d1ca78c626a53577199e9c57">Reference</a></p>

<p>필자는 흑 또는 백으로만 결과 이미지가 나오게끔 하고 싶기 때문에 type 인자로서 cv::ThresholdTypes인 Threshold Binary를 보내주었다.</p>

<p>또한, 백이 나오려면 maxval의 값은 255가 되어야 하므로, 255를 인자로 보내주었다.</p>

<p>즉 이를 코드로 보이면,</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>          <span class="c1">// draw_Line Function 반환 값을 저장할 변수 선언</span>
    <span class="kt">double</span> <span class="n">median</span><span class="p">;</span>              <span class="c1">// 중앙값을 저장할 변수 선언</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">dst</span><span class="p">;</span>        <span class="c1">// threshold 처리 후 결과 이미지를 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>         <span class="c1">// 반환 값을 담자.</span>

    <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

    <span class="n">threshold</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">THRESH_BINARY</span><span class="p">);</span>       <span class="c1">// threshold Function 호출</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>이렇게 한 후 threshold Function 처리 후의 결과 이미지를 확인해보자.</p>

<p>우리가 위에서 dst Mat 객체를 결과 이미지로 설정했기 때문에 imshow 함수를 이용해서 단순히 dst 이미지를 띄워주기만 하면 된다.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>          <span class="c1">// draw_Line Function 반환 값을 저장할 변수 선언</span>
    <span class="kt">double</span> <span class="n">median</span><span class="p">;</span>              <span class="c1">// 중앙값을 저장할 변수 선언</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">dst</span><span class="p">;</span>        <span class="c1">// threshold 처리 후 결과 이미지를 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>         <span class="c1">// 반환 값을 담자.</span>

    <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

    <span class="n">threshold</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">THRESH_BINARY</span><span class="p">);</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Result"</span><span class="p">,</span> <span class="n">dst</span><span class="p">);</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>위 코드의 실행 결과가 아래와 같다면 성공이다.</p>

<p><img src="/assets/images/opencv/assignment/opencv-assign-8.png" alt="Result" /></p>

<p>이제 정말 마지막이다.</p>

<blockquote>
  <p>가장 어두운 직사각형은 파랑색, 원은 녹색, 삼각형은 빨강색, 배경은 노랑색으로 하여 img2를 만들어 display하시오.</p>
</blockquote>

<p>필자는 위의 threshold Function 처리 결과 도출된 이미지에서 다음과 같은 하나의 패턴을 발견할 수 있었다.</p>

<blockquote>
  <p>흰색, 검은색, 흰색, 검은색, 흰색, 검은색, 흰색의 순서이다.</p>
</blockquote>

<p>그래서 필자는 dst 이미지에 대해서 왼쪽에서부터 오른쪽으로 순차적으로 Elements들에 접근하여 만약에 지금 현재 Element의 값이 0이면, 즉 검은색이면 count의 값이 0일 때는 파랑색을, 1일 때는 초록색을, 2일 때는 빨간색을 칠하게끔 작성하였으며, 또 그 다음 Element의 값이 255이면, 즉 흰색이면 count가 2인지 검사하여 만약 그렇다면 다시 0으로, 그렇지 않다면 +1 시키는 방식으로 진행했다.</p>

<p>또한, 지금 현재 Element의 값이 255이면, 즉 흰색이면 노랑색을 칠하게끔 작성했다.</p>

<p>그런데 만약 위에서 필자가 생각해낸 방식에서 count의 값이 2일 때 다시 0으로 만들어주는 조건식이 존재하지 않는다면 어떤 문제가 발생할까?</p>

<p>아래는 이러한 조건식이 존재하지 않는 상황에서의 코드의 동작을 나타낸 것이다.</p>

<blockquote>
  <p>직사각형에서 흰색 배경을 만났을 때 기존 0에서 1로 count의 값이 증가하고, 마찬가지로 원에서 흰색 배경을 만났을 경우에도 기존 count 값인 1에서 2로 증가를 하게 되며, 마지막으로 삼각형에서 흰색 배경을 만났을 때는 count 값이 기존 2에서 3으로 증가한다.</p>
</blockquote>

<blockquote>
  <p>문제점을 찾았는가?</p>
</blockquote>

<p>필자는 count의 값이 0일 때와 1일 때 그리고 2일 때에 대해서만 그에 맞는 색깔을 칠해주는 조건을 걸었기 때문에 3에 대응되는 조건은 없어서 색깔이 칠해지지 않는 문제가 발생한다.</p>

<p>(더군다나 count의 값은 계속 증가하게 된다.)</p>

<p>그리하여 필자는 count의 값이 2일 때 다시 0으로 만들어주는 조건을 걸어두었다.</p>

<p>이를 코드로 보이면 다음과 같다.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                      <span class="c1">// count의 값은 0으로 초기화한다.</span>

<span class="n">uchar</span> <span class="o">*</span><span class="n">data_input</span> <span class="o">=</span> <span class="n">dst</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>       <span class="c1">// dst 이미지의 Element에 접근하기 위한 data_input 포인터 변수, 실제 조건의 대상은 dst 이미지이다.</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">img2</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">uchar</span> <span class="o">*</span><span class="n">data_output</span> <span class="o">=</span> <span class="n">img2</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>     <span class="c1">// img2 이미지 위에 색깔을 그리기 위해 Element에 접근하는 data_output 포인터 변수</span>

        <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>        <span class="c1">// 현재 Element의 값이 0이면, 즉 검은색이면</span>
            <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>                         <span class="c1">// 그때의 count 값이 0이면, 파랑색</span>
            <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>           <span class="c1">// B</span>
            <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">144</span><span class="p">;</span>       <span class="c1">// G</span>
            <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>        <span class="c1">// R</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>                 <span class="c1">// 그때의 count 값이 1이면, 초록색</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>         <span class="c1">// B</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>   <span class="c1">// G</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// R</span>
            <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>                  <span class="c1">// 그때의 count 값이 2이면, 빨강색</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>         <span class="c1">// B</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// G</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>   <span class="c1">// R</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// 다음 Element의 값이 255이면, 즉 흰색이면</span>
                <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>          <span class="c1">// 그때의 count 값이 2라면</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>          <span class="c1">// 0으로 변경</span>
                <span class="k">else</span>                    <span class="c1">// 2가 아니라면</span>
                    <span class="n">count</span><span class="o">++</span><span class="p">;</span>            <span class="c1">// count 값을 1만큼 증가</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// 현재 Element의 값이 255이면, 즉 흰색이면 노랑색</span>
            <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>             <span class="c1">// B</span>
            <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>       <span class="c1">// G</span>
            <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>       <span class="c1">// R</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>위 코드로부터 알 수 있는 사실은</p>

<blockquote>
  <p>OpenCV에서 Color Image Matrix는 우리가 기존에 알고 있던 R, G, B 순서가 아닌 B, G, R 순서이다.</p>
</blockquote>

<p>라는 점과 img2의 경우에는 dst와는 달리 3 channel Matrix라서(img2를 불러들일 때 IMREAD_COLOR로 불러들인 것을 기억하고 있는가?) +0, +1, +2로 각각 B, G, R에 접근할 수 있다는 점이다.</p>

<p>이제 필자가 생각하여 작성한 코드가 문제의 5번 항목에서 요구한 바를 충족시켜주는지를 확인해보자.</p>

<p>img2에 대해서 색깔을 칠해주었으므로 imshow 함수의 인자로 img2를 보내주자.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>          <span class="c1">// draw_Line Function 반환 값을 저장할 변수 선언</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">iter</span><span class="p">;</span>
    
    <span class="kt">double</span> <span class="n">median</span><span class="p">;</span>              <span class="c1">// 중앙값을 저장할 변수 선언</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>
    
    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">dst</span><span class="p">;</span>        <span class="c1">// threshold 처리 후 결과 이미지를 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>         <span class="c1">// 반환 값을 담자.</span>
    
    <span class="k">for</span><span class="p">(</span><span class="n">iter</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">iter</span> <span class="o">!=</span> <span class="n">peaks</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">iter</span><span class="o">++</span><span class="p">)</span>
        <span class="n">cout</span><span class="o">&lt;&lt;*</span><span class="n">iter</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

    <span class="n">threshold</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">THRESH_BINARY</span><span class="p">);</span>
    
    <span class="n">uchar</span> <span class="o">*</span><span class="n">data_input</span> <span class="o">=</span> <span class="n">dst</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">img2</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">uchar</span> <span class="o">*</span><span class="n">data_output</span> <span class="o">=</span> <span class="n">img2</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>     <span class="c1">// img2 이미지 위에 색깔을 그리기 위해 Element에 접근하는 data_output 포인터 변수</span>

            <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>        <span class="c1">// 현재 Element의 값이 0이면, 즉 검은색이면</span>
                <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>                         <span class="c1">// 그때의 count 값이 0이면, 파랑색</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>           <span class="c1">// B</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">144</span><span class="p">;</span>       <span class="c1">// G</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>        <span class="c1">// R</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>                 <span class="c1">// 그때의 count 값이 1이면, 초록색</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>         <span class="c1">// B</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>   <span class="c1">// G</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// R</span>
                <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>                  <span class="c1">// 그때의 count 값이 2이면, 빨강색</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>         <span class="c1">// B</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// G</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>   <span class="c1">// R</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// 다음 Element의 값이 255이면, 즉 흰색이면</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>          <span class="c1">// 그때의 count 값이 2라면</span>
                        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>          <span class="c1">// 0으로 변경</span>
                    <span class="k">else</span>                    <span class="c1">// 2가 아니라면</span>
                        <span class="n">count</span><span class="o">++</span><span class="p">;</span>            <span class="c1">// count 값을 1만큼 증가</span>
                <span class="p">}</span>
            <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// 현재 Element의 값이 255이면, 즉 흰색이면 노랑색</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>             <span class="c1">// B</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>       <span class="c1">// G</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>       <span class="c1">// R</span>
            <span class="p">}</span>
        <span class="p">}</span>   
    <span class="p">}</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Result"</span><span class="p">,</span> <span class="n">img2</span><span class="p">);</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>다음과 같은 이미지가 출력되었다면, 성공이다.</p>

<p><img src="/assets/images/opencv/assignment/opencv-assign-9.png" alt="Result" /></p>

<p>전체 코드를 보이면서 OpenCV 색상 채우기 과제를 마무리 짓겠다.</p>

<h3 id="전체-코드">전체 코드</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;opencv2/opencv.hpp&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">cv</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">find_Peaks</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">src</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>      <span class="c1">// peaks들의 값을 저장할 변수</span>
        <span class="n">Mat</span> <span class="n">dup_src</span><span class="p">;</span>            <span class="c1">// 매개변수 src를 복제하여 저장할 변수</span>
        
        <span class="n">Point</span> <span class="n">p</span><span class="p">;</span>        <span class="c1">// 최댓값의 위치를 저장하는 변수</span>
        
        <span class="n">dup_src</span> <span class="o">=</span> <span class="n">src</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>      <span class="c1">// 매개변수 src를 복제하여 dup_src에 담는다.</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// 위 이미지에서 보여지는 히스토그램이 4개 있으므로, 4회 반복.</span>
            <span class="n">minMaxLoc</span><span class="p">(</span><span class="n">dup_src</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">);</span>       <span class="c1">// 우리는 위치값만 필요하므로 최대와 최솟값을 저장할 변수는 필요치 않음.</span>
            <span class="n">peaks</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>       <span class="c1">// 위치 값 중 y값만을 peaks에 담자. 실제로 가장 큰 Peak를 가지는 히스토그램의 y값이 먼저 담기므로, 실제로 히스토그램 위에 Line을 그릴 때는 가장 작은 Peak를 가지는 히스토그램부터 그려진다. (Stack)</span>
            <span class="n">dup_src</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>        <span class="c1">// 필자는 단순히 최솟값으로서 0을 채택했다.</span>

            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>           <span class="c1">// p.y의 주변 반경 10만큼을 0으로 채운다.</span>
                <span class="n">dup_src</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">dup_src</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">peaks</span><span class="p">;</span>       <span class="c1">// peaks 값들 반환</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span> <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">hist</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span> <span class="o">=</span> <span class="n">find_Peaks</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">bin_w</span> <span class="o">=</span> <span class="n">cvRound</span><span class="p">(</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">hist</span><span class="p">.</span><span class="n">cols</span> <span class="o">/</span> <span class="mi">350</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">line</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hist</span><span class="p">.</span><span class="n">rows</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Peaks"</span><span class="p">,</span> <span class="n">hist</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">peaks</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Mat</span> <span class="nf">draw_Histogram</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">hist</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">hist_w</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">hist_h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">hist_size</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">bin_w</span> <span class="o">=</span> <span class="n">cvRound</span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">hist_w</span><span class="o">/</span><span class="n">hist_size</span><span class="p">);</span>

    <span class="n">Mat</span> <span class="n">histImage</span><span class="p">(</span><span class="n">hist_h</span><span class="p">,</span> <span class="n">hist_w</span><span class="p">,</span> <span class="n">CV_8UC3</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>

    <span class="n">normalize</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">histImage</span><span class="p">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">NORM_MINMAX</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Mat</span><span class="p">());</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">hist_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Point</span> <span class="n">pts</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">hist_h</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">hist_h</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">hist_h</span> <span class="o">-</span> <span class="n">cvRound</span><span class="p">(</span><span class="n">hist</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">hist_h</span><span class="o">-</span><span class="n">cvRound</span><span class="p">(</span><span class="n">hist</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">Point</span><span class="p">(</span><span class="n">bin_w</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">hist_h</span><span class="p">)};</span>

        <span class="n">fillConvexPoly</span><span class="p">(</span><span class="n">histImage</span><span class="p">,</span> <span class="n">pts</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Histogram"</span><span class="p">,</span> <span class="n">histImage</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">histImage</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">histSize</span> <span class="o">=</span> <span class="mi">350</span><span class="p">;</span>

    <span class="kt">float</span> <span class="n">range</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">};</span>
    <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">histRange</span> <span class="o">=</span> <span class="p">{</span><span class="n">range</span><span class="p">};</span>

    <span class="kt">bool</span> <span class="n">uniform</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">accumulate</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">peaks</span><span class="p">;</span>          <span class="c1">// draw_Line Function 반환 값을 저장할 변수 선언</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">iter</span><span class="p">;</span>
    
    <span class="kt">double</span> <span class="n">median</span><span class="p">;</span>              <span class="c1">// 중앙값을 저장할 변수 선언</span>
    
    <span class="n">Mat</span> <span class="n">img1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">"/Users/hexk/Desktop/test1.jpg"</span><span class="p">,</span> <span class="n">IMREAD_COLOR</span><span class="p">);</span>
    
    <span class="n">Mat</span> <span class="n">b_hist</span><span class="p">;</span>     <span class="c1">// 히스토그램이 저장될 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">histImg</span><span class="p">;</span>    <span class="c1">// draw_histogram 반환값을 저장하기 위한 Mat 객체 생성</span>
    <span class="n">Mat</span> <span class="n">dst</span><span class="p">;</span>        <span class="c1">// threshold 처리 후 결과 이미지를 저장하기 위한 Mat 객체 생성</span>

    <span class="n">calcHist</span><span class="p">(</span><span class="o">&amp;</span><span class="n">img1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">b_hist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histSize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">histRange</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">);</span>

    <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">b_hist</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>        <span class="c1">// 9x9 가우시안 필터 적용</span>

    <span class="n">histImg</span> <span class="o">=</span> <span class="n">draw_Histogram</span><span class="p">(</span><span class="n">b_hist</span><span class="p">);</span>
    
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">draw_Line</span><span class="p">(</span><span class="n">b_hist</span><span class="p">,</span> <span class="n">histImg</span><span class="p">);</span>         <span class="c1">// 반환 값을 담자.</span>
    
    <span class="k">for</span><span class="p">(</span><span class="n">iter</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">iter</span> <span class="o">!=</span> <span class="n">peaks</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">iter</span><span class="o">++</span><span class="p">)</span>
        <span class="n">cout</span><span class="o">&lt;&lt;*</span><span class="n">iter</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">peaks</span><span class="p">.</span><span class="n">at</span><span class="p">((</span><span class="n">peaks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

    <span class="n">threshold</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">THRESH_BINARY</span><span class="p">);</span>
    
    <span class="n">imshow</span><span class="p">(</span><span class="s">"p1"</span><span class="p">,</span> <span class="n">img1</span><span class="p">);</span>
    <span class="n">imshow</span><span class="p">(</span><span class="s">"p2"</span><span class="p">,</span> <span class="n">dst</span><span class="p">);</span>
    
    <span class="n">uchar</span> <span class="o">*</span><span class="n">data_input</span> <span class="o">=</span> <span class="n">dst</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">img2</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">uchar</span> <span class="o">*</span><span class="n">data_output</span> <span class="o">=</span> <span class="n">img2</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>     <span class="c1">// img2 이미지 위에 색깔을 그리기 위해 Element에 접근하는 data_output 포인터 변수</span>

            <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>        <span class="c1">// 현재 Element의 값이 0이면, 즉 검은색이면</span>
                <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>                         <span class="c1">// 그때의 count 값이 0이면, 파랑색</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>           <span class="c1">// B</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">144</span><span class="p">;</span>       <span class="c1">// G</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>        <span class="c1">// R</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>                 <span class="c1">// 그때의 count 값이 1이면, 초록색</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>         <span class="c1">// B</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>   <span class="c1">// G</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// R</span>
                <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>                  <span class="c1">// 그때의 count 값이 2이면, 빨강색</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>         <span class="c1">// B</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// G</span>
                    <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>   <span class="c1">// R</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// 다음 Element의 값이 255이면, 즉 흰색이면</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>          <span class="c1">// 그때의 count 값이 2라면</span>
                        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>          <span class="c1">// 0으로 변경</span>
                    <span class="k">else</span>                    <span class="c1">// 2가 아니라면</span>
                        <span class="n">count</span><span class="o">++</span><span class="p">;</span>            <span class="c1">// count 값을 1만큼 증가</span>
                <span class="p">}</span>
            <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">data_input</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// 현재 Element의 값이 255이면, 즉 흰색이면 노랑색</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>             <span class="c1">// B</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>       <span class="c1">// G</span>
                <span class="n">data_output</span><span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="n">img2</span><span class="p">.</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>       <span class="c1">// R</span>
            <span class="p">}</span>
        <span class="p">}</span>   
    <span class="p">}</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">"Result"</span><span class="p">,</span> <span class="n">img2</span><span class="p">);</span>
    
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#algorithms" class="page__taxonomy-item" rel="tag">Algorithms</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#coding" class="page__taxonomy-item" rel="tag">Coding</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#opencv" class="page__taxonomy-item" rel="tag">OpenCV</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#programming" class="page__taxonomy-item" rel="tag">Programming</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#algorithms" class="page__taxonomy-item" rel="tag">Algorithms</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#opencv" class="page__taxonomy-item" rel="tag">OpenCV</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2021-02-26T00:00:00+09:00">February 26, 2021</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=OpenCV+%EA%B3%BC%EC%A0%9C%3A+%EC%98%81%EC%83%81+%EC%83%89%EC%83%81+%EC%B1%84%EC%9A%B0%EA%B8%B0+%233+-+%EC%B5%9C%EC%A2%85%20http%3A%2F%2Flocalhost%3A4000%2Fopencv%2Falgorithms%2FAssign-OpenCV-3%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fopencv%2Falgorithms%2FAssign-OpenCV-3%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fopencv%2Falgorithms%2FAssign-OpenCV-3%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/opencv/algorithms/Assign-OpenCV-2/" class="pagination--pager" title="OpenCV 과제: 영상 색상 채우기 #2
">이전</a>
    
    
      <a href="/algorithms/Studying-Algorithm-3/" class="pagination--pager" title="BOJ: 1934 최소공배수
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/algorithms/Studying-Algorithm-70/" rel="permalink">BOJ: 10926 ??!
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-06-28T00:00:00+09:00">June 28, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          최대 1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">문제

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/algorithms/Studying-Algorithm-69/" rel="permalink">BOJ: 15059 Hard choice
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-06-27T00:00:00+09:00">June 27, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">문제

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/algorithms/Studying-Algorithm-68/" rel="permalink">BOJ: 9653 스타워즈 로고
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-06-26T00:00:00+09:00">June 26, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          최대 1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">문제

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/algorithms/Studying-Algorithm-67/" rel="permalink">BOJ: 11720 숫자의 합
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-06-25T00:00:00+09:00">June 25, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          최대 1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">문제

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
          <li><a href="https://github.com/enfycius" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.instagram.com/___o7k/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 종혁. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/opencv/algorithms/Assign-OpenCV-3/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/opencv/algorithms/Assign OpenCV-3"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://enfycius.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
       processEscapes: true
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
   });
</script>


  </body>
</html>
